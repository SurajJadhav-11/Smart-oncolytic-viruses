import matplotlib.pyplot as plt
import numpy as np

# Simulation parameters: 24-hour safety window
time = np.linspace(0, 24, 100)

# Base logic for healthy cell RNA concentration (Lock 2)
# We vary the decay rate to simulate different patient nuclease levels
rates_to_test = np.linspace(-0.2, -0.6, 6) 

plt.figure(figsize=(10, 6))

for rate in rates_to_test:
    # Logic: Concentration = Initial * e^(rate * time)
    concentration = np.exp(rate * time)
    plt.plot(time, concentration, alpha=0.7, label=f'Decay Rate: {abs(rate):.1f}')

# Safety Threshold: Below 0.1, the virus is neutralized
plt.axhline(y=0.1, color='red', linestyle='--', alpha=0.5, label='Safety Threshold')
plt.fill_between(time, 0, 0.1, color='green', alpha=0.1)

plt.title('Sensitivity Analysis: Lock 2 Robustness', fontsize=14)
plt.xlabel('Time (Hours)', fontsize=12)
plt.ylabel('Relative Viral RNA Concentration', fontsize=12)
plt.yscale('log') # Log scale for biological decay
plt.grid(True, which="both", ls="-", alpha=0.3)
plt.legend()

# Save the result to be uploaded to your /results folder
plt.savefig('sensitivity_results.png')
print("Simulation complete. Image 'sensitivity_results.png' generated.")
